import{r as a,j as e}from"./index-D4B_nToJ.js";import{f as o,S as h,A as S}from"./AnimatedSubmitButton-BcrKmBWu.js";import{b as k}from"./api-3RAAH5mw.js";import{R as C}from"./ResultCard-Cc0DAtfA.js";function _({offerId:d}){const[c,b]=a.useState(null),[j,u]=a.useState(!0),[x,i]=a.useState(null),[n,p]=a.useState(1e5),[r,g]=a.useState(0),[v,f]=a.useState(!1),[l,N]=a.useState(null);a.useEffect(()=>{async function t(){try{u(!0);const s=await k(d);if(!s){i("Offer not found");return}if(s.status==="invalid"){i("Invalid offer link");return}if(s.status==="expired"){i("Offer has expired");return}b(s)}catch(s){i(s.message||"Failed to load offer")}finally{u(!1)}}t()},[d]);const w=async()=>{try{f(!0);const t=await fetch(`http://localhost:3000/api/offers/${d}/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({candidateBaseMin:n,candidateEquityMin:c.equityEnabled?r:0})}),s=await t.json();if(!t.ok)throw new Error(s.error||"Failed to submit response");let m=null;s.status==="close"?m=8:s.status==="fail"&&(m=15),N({status:s.status,finalOffer:s.final,suggested:s.suggested,gapPercent:m,resultId:s.resultId})}catch(t){alert("Error submitting response: "+t.message)}finally{f(!1)}};if(j)return e.jsx("div",{className:"bg-white rounded-3xl p-6 md:p-8 shadow-xl animate-[cardIn_280ms_ease-out]",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-8 bg-slate-200 rounded w-1/3 mx-auto"}),e.jsx("div",{className:"h-4 bg-slate-100 rounded w-2/3 mx-auto"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-slate-100 rounded w-1/4"}),e.jsx("div",{className:"h-10 bg-slate-200 rounded w-full"}),e.jsx("div",{className:"h-2 bg-slate-200 rounded-full w-full"})]}),e.jsx("div",{className:"h-12 bg-slate-200 rounded-full w-full"})]})});if(x)return e.jsxs("div",{className:"bg-white rounded-3xl p-6 md:p-8 shadow-xl animate-[cardIn_280ms_ease-out]",children:[e.jsxs("header",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-slate-50 ring-4 ring-rose-100 text-4xl text-rose-600 animate-[emojiPop_260ms_ease-out]",children:e.jsx("span",{children:"⚠️"})}),e.jsx("h1",{className:"text-2xl md:text-3xl font-semibold text-slate-900",children:"Oops"}),e.jsx("p",{className:"mt-2 text-sm md:text-base text-slate-600",children:x})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>window.location.hash="",className:"w-full rounded-full bg-slate-900 text-white py-3 text-sm font-medium hover:bg-slate-800 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-900 focus-visible:ring-offset-2 transition-all active:scale-[0.98]",children:"Go to home"})})]});if(l)return e.jsx(C,{status:l.status,finalOffer:l.finalOffer,suggested:l.suggested,gapPercent:l.gapPercent,resultId:l.resultId});const y=n+(c.equityEnabled?r:0);return e.jsxs("div",{className:"bg-white rounded-3xl p-6 md:p-8 shadow-xl animate-[cardIn_280ms_ease-out]",children:[e.jsx("div",{className:"inline-flex items-center justify-center px-3 py-1 mb-3 rounded-full bg-[#E6F9FA] text-xs font-medium text-[#007C80]",children:"Candidate view"}),e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Candidate View"}),e.jsx("p",{className:"text-slate-600 mb-2",children:"Enter your minimum acceptable offer. The company will never see this number."}),e.jsxs("div",{className:"mb-6 inline-flex items-center gap-2 text-sm text-[#555]",children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("span",{children:"We only show the final number, never your inputs."})]}),e.jsxs("div",{className:"mb-6 flex items-center justify-center gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-emerald-500 text-white font-semibold",children:"✓"}),e.jsx("span",{className:"font-medium text-emerald-600",children:"Set Minimum"})]}),e.jsx("div",{className:"h-px w-8 bg-emerald-500"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-slate-900 text-white font-semibold",children:"2"}),e.jsx("span",{className:"font-semibold text-slate-900",children:"Submit"})]}),e.jsx("div",{className:"h-px w-8 bg-slate-300"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-slate-200 text-slate-500 font-semibold",children:"3"}),e.jsx("span",{className:"text-slate-500",children:"See Result"})]})]}),e.jsxs("div",{className:"space-y-6 mb-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Minimum Base Salary"}),e.jsx("div",{className:"text-3xl font-bold mb-4",children:o(n)}),e.jsx(h,{value:n,min:5e4,max:3e5,step:5e3,onChange:t=>p(Number(t.target.value)),variant:"candidate",label:"Candidate minimum base"})]}),c.equityEnabled&&e.jsxs("div",{className:"animate-slideDown",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Minimum Equity (Annual Value)"}),e.jsx("div",{className:"text-3xl font-bold mb-4",children:o(r)}),e.jsx(h,{value:r,min:0,max:2e5,step:5e3,onChange:t=>g(Number(t.target.value)),variant:"candidate",label:"Candidate minimum equity"})]}),e.jsx("div",{className:"pt-4 border-t border-slate-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Total Minimum"}),e.jsx("span",{className:"text-2xl font-bold text-slate-900",children:o(y)})]})})]}),e.jsx(S,{onClick:w,buttonText:"Lock it in & See Result",disabled:v})]})}export{_ as CandidateView};
//# sourceMappingURL=CandidateView-CDF1ifQ5.js.map
