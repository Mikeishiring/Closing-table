{"version":3,"file":"CandidateView-KGzZnkFz.js","sources":["../../src/views/CandidateView.jsx"],"sourcesContent":["/**\n * Candidate View\n * Where candidates respond to offers\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { SignatureSlider } from '../components/SignatureSlider';\nimport { AnimatedSubmitButton } from '../components/AnimatedSubmitButton';\nimport { getOffer, submitResponse } from '../lib/api';\nimport { formatCurrency, LIMITS } from '../lib/deal-math';\nimport { ResultCard } from '../components/ResultCard';\n\nexport function CandidateView({ offerId }) {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [baseMin, setBaseMin] = useState(100000);\n  const [submitting, setSubmitting] = useState(false);\n  const [result, setResult] = useState(null);\n\n  useEffect(() => {\n    async function fetchOffer() {\n      try {\n        setLoading(true);\n        const data = await getOffer(offerId);\n        \n        if (!data) {\n          setError('Offer not found');\n          return;\n        }\n        \n        if (data.status === 'invalid') {\n          setError('Invalid offer link');\n          return;\n        }\n        \n        if (data.status === 'expired') {\n          setError('Offer has expired');\n          return;\n        }\n      } catch (err) {\n        setError(err.message || 'Failed to load offer');\n      } finally {\n        setLoading(false);\n      }\n    }\n    \n    fetchOffer();\n  }, [offerId]);\n\n  const handleSubmit = async () => {\n    try {\n      setSubmitting(true);\n      \n      // Client-side validation for sanity\n      if (baseMin < LIMITS.TOTAL_MIN || baseMin > LIMITS.TOTAL_MAX) {\n        throw new Error(\n          `Please keep your minimum between ${formatCurrency(LIMITS.TOTAL_MIN)} and ${formatCurrency(LIMITS.TOTAL_MAX)}.`\n        );\n      }\n      \n      const data = await submitResponse(offerId, {\n        min: baseMin,\n      });\n      \n      // Calculate gap percentage for display\n      let gapPercent = null;\n      if (data.status === 'close') {\n        gapPercent = 8; // Approximate, within bridge zone\n      } else if (data.status === 'fail') {\n        gapPercent = 15; // Approximate, above bridge zone\n      }\n      \n      setResult({\n        status: data.status,\n        finalOffer: data.final,\n        suggested: data.suggested,\n        gapPercent,\n        resultId: data.resultId,\n      });\n    } catch (err) {\n      alert('Error submitting response: ' + err.message);\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"bg-white rounded-3xl p-6 md:p-8 shadow-xl animate-[cardIn_280ms_ease-out]\">\n        <div className=\"animate-pulse space-y-6\">\n          <div className=\"space-y-2\">\n            <div className=\"h-8 bg-slate-200 rounded w-1/3 mx-auto\" />\n            <div className=\"h-4 bg-slate-100 rounded w-2/3 mx-auto\" />\n          </div>\n          <div className=\"space-y-2\">\n            <div className=\"h-4 bg-slate-100 rounded w-1/4\" />\n            <div className=\"h-10 bg-slate-200 rounded w-full\" />\n            <div className=\"h-2 bg-slate-200 rounded-full w-full\" />\n          </div>\n          <div className=\"h-12 bg-slate-200 rounded-full w-full\" />\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-white rounded-3xl p-6 md:p-8 shadow-xl animate-[cardIn_280ms_ease-out]\">\n        <header className=\"flex flex-col items-center text-center\">\n          <div className=\"mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-slate-50 ring-4 ring-rose-100 text-4xl text-rose-600 animate-[emojiPop_260ms_ease-out]\">\n            <span>⚠️</span>\n          </div>\n          <h1 className=\"text-2xl md:text-3xl font-semibold text-slate-900\">\n            Oops\n          </h1>\n          <p className=\"mt-2 text-sm md:text-base text-slate-600\">\n            {error}\n          </p>\n        </header>\n        \n        <div className=\"mt-6\">\n          <button\n            onClick={() => window.location.hash = ''}\n            className=\"w-full rounded-full bg-slate-900 text-white py-3 text-sm font-medium hover:bg-slate-800 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-900 focus-visible:ring-offset-2 transition-all active:scale-[0.98]\"\n          >\n            Start over\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  if (result) {\n    return (\n      <ResultCard\n        status={result.status}\n        finalOffer={result.finalOffer}\n        suggested={result.suggested}\n        gapPercent={result.gapPercent}\n        resultId={result.resultId}\n      />\n    );\n  }\n\n  const totalMin = baseMin;\n\n  return (\n    <div className=\"bg-white rounded-3xl p-6 md:p-8 shadow-xl animate-[cardIn_280ms_ease-out]\">\n      <div className=\"inline-flex items-center justify-center px-3 py-1 mb-3 rounded-full bg-[#E6F9FA] text-xs font-medium text-[#007C80]\">\n        Candidate view\n      </div>\n      <h2 className=\"section-title mb-2\">Candidate View</h2>\n      <p className=\"section-lead mb-2\">\n        Enter your minimum acceptable offer. The company will never see this number.\n      </p>\n\n      {/* Privacy note */}\n      <div className=\"mb-6 inline-flex items-center gap-2 text-sm text-[#555]\">\n        <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n          <path d=\"M7 11V7a5 5 0 0 1 10 0v4\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n        </svg>\n        <span>We only show the final number, never your inputs.</span>\n      </div>\n\n      {/* Progress header */}\n      <div className=\"mb-6 flex items-center justify-center gap-2 text-xs\">\n        <div className=\"flex items-center gap-1\">\n          <div className=\"flex h-6 w-6 items-center justify-center rounded-full bg-emerald-500 text-white font-semibold\">\n            ✓\n          </div>\n          <span className=\"font-medium text-emerald-600\">Set Minimum</span>\n        </div>\n        <div className=\"h-px w-8 bg-emerald-500\" />\n        <div className=\"flex items-center gap-1\">\n          <div className=\"flex h-6 w-6 items-center justify-center rounded-full bg-slate-900 text-white font-semibold\">\n            2\n          </div>\n          <span className=\"font-semibold text-slate-900\">Submit</span>\n        </div>\n        <div className=\"h-px w-8 bg-slate-300\" />\n        <div className=\"flex items-center gap-1\">\n          <div className=\"flex h-6 w-6 items-center justify-center rounded-full bg-slate-200 text-slate-500 font-semibold\">\n            3\n          </div>\n          <span className=\"text-slate-500\">See Result</span>\n        </div>\n      </div>\n\n      <div className=\"space-y-6 mb-8\">\n        {/* Base Salary */}\n        <div>\n          <label className=\"block text-sm font-medium text-slate-700 mb-2\">\n            Minimum Base Salary\n          </label>\n          <div className=\"text-3xl font-bold mb-4\">\n            {formatCurrency(baseMin)}\n          </div>\n          <SignatureSlider\n            value={baseMin}\n            min={50000}\n            max={300000}\n            step={5000}\n            onChange={(e) => setBaseMin(Number(e.target.value))}\n            variant=\"candidate\"\n            label=\"Candidate minimum base\"\n          />\n        </div>\n\n        {/* Total */}\n        <div className=\"pt-4 border-t border-slate-200\">\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-sm font-medium text-slate-700\">Total Minimum</span>\n            <span className=\"text-2xl font-bold text-slate-900\">{formatCurrency(totalMin)}</span>\n          </div>\n        </div>\n      </div>\n\n      <AnimatedSubmitButton\n        onClick={handleSubmit}\n        buttonText=\"Lock it in & See Result\"\n        disabled={submitting}\n      />\n    </div>\n  );\n}\n"],"names":["CandidateView","offerId","loading","setLoading","useState","error","setError","baseMin","setBaseMin","submitting","setSubmitting","result","setResult","useEffect","fetchOffer","data","getOffer","err","handleSubmit","LIMITS","formatCurrency","submitResponse","gapPercent","jsxs","jsx","ResultCard","totalMin","SignatureSlider","e","AnimatedSubmitButton"],"mappings":"qNAYO,SAASA,EAAc,CAAE,QAAAC,GAAW,CACzC,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,EAAI,EACrC,CAACC,EAAOC,CAAQ,EAAIF,EAAAA,SAAS,IAAI,EACjC,CAACG,EAASC,CAAU,EAAIJ,EAAAA,SAAS,GAAM,EACvC,CAACK,EAAYC,CAAa,EAAIN,EAAAA,SAAS,EAAK,EAC5C,CAACO,EAAQC,CAAS,EAAIR,EAAAA,SAAS,IAAI,EAEzCS,EAAAA,UAAU,IAAM,CACd,eAAeC,GAAa,CAC1B,GAAI,CACFX,EAAW,EAAI,EACf,MAAMY,EAAO,MAAMC,EAASf,CAAO,EAEnC,GAAI,CAACc,EAAM,CACTT,EAAS,iBAAiB,EAC1B,MACF,CAEA,GAAIS,EAAK,SAAW,UAAW,CAC7BT,EAAS,oBAAoB,EAC7B,MACF,CAEA,GAAIS,EAAK,SAAW,UAAW,CAC7BT,EAAS,mBAAmB,EAC5B,MACF,CACF,OAASW,EAAK,CACZX,EAASW,EAAI,SAAW,sBAAsB,CAChD,QAAA,CACEd,EAAW,EAAK,CAClB,CACF,CAEAW,EAAA,CACF,EAAG,CAACb,CAAO,CAAC,EAEZ,MAAMiB,EAAe,SAAY,CAC/B,GAAI,CAIF,GAHAR,EAAc,EAAI,EAGdH,EAAUY,EAAO,WAAaZ,EAAUY,EAAO,UACjD,MAAM,IAAI,MACR,oCAAoCC,EAAeD,EAAO,SAAS,CAAC,QAAQC,EAAeD,EAAO,SAAS,CAAC,GAAA,EAIhH,MAAMJ,EAAO,MAAMM,EAAepB,EAAS,CACzC,IAAKM,CAAA,CACN,EAGD,IAAIe,EAAa,KACbP,EAAK,SAAW,QAClBO,EAAa,EACJP,EAAK,SAAW,SACzBO,EAAa,IAGfV,EAAU,CACR,OAAQG,EAAK,OACb,WAAYA,EAAK,MACjB,UAAWA,EAAK,UAChB,WAAAO,EACA,SAAUP,EAAK,QAAA,CAChB,CACH,OAASE,EAAK,CACZ,MAAM,8BAAgCA,EAAI,OAAO,CACnD,QAAA,CACEP,EAAc,EAAK,CACrB,CACF,EAEA,GAAIR,EACF,aACG,MAAA,CAAI,UAAU,4EACb,SAAAqB,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,wCAAA,CAAyC,EACxDA,EAAAA,IAAC,MAAA,CAAI,UAAU,wCAAA,CAAyC,CAAA,EAC1D,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,gCAAA,CAAiC,EAChDA,EAAAA,IAAC,MAAA,CAAI,UAAU,kCAAA,CAAmC,EAClDA,EAAAA,IAAC,MAAA,CAAI,UAAU,sCAAA,CAAuC,CAAA,EACxD,EACAA,EAAAA,IAAC,MAAA,CAAI,UAAU,uCAAA,CAAwC,CAAA,CAAA,CACzD,CAAA,CACF,EAIJ,GAAInB,EACF,OACEkB,EAAAA,KAAC,MAAA,CAAI,UAAU,4EACb,SAAA,CAAAA,EAAAA,KAAC,SAAA,CAAO,UAAU,yCAChB,SAAA,CAAAC,EAAAA,IAAC,OAAI,UAAU,yJACb,SAAAA,MAAC,OAAA,CAAK,cAAE,CAAA,CACV,EACAA,EAAAA,IAAC,KAAA,CAAG,UAAU,oDAAoD,SAAA,OAElE,EACAA,EAAAA,IAAC,IAAA,CAAE,UAAU,2CACV,SAAAnB,CAAA,CACH,CAAA,EACF,EAEAmB,EAAAA,IAAC,MAAA,CAAI,UAAU,OACb,SAAAA,EAAAA,IAAC,SAAA,CACC,QAAS,IAAM,OAAO,SAAS,KAAO,GACtC,UAAU,sOACX,SAAA,YAAA,CAAA,CAED,CACF,CAAA,EACF,EAIJ,GAAIb,EACF,OACEa,EAAAA,IAACC,EAAA,CACC,OAAQd,EAAO,OACf,WAAYA,EAAO,WACnB,UAAWA,EAAO,UAClB,WAAYA,EAAO,WACnB,SAAUA,EAAO,QAAA,CAAA,EAKvB,MAAMe,EAAWnB,EAEjB,OACEgB,EAAAA,KAAC,MAAA,CAAI,UAAU,4EACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,sHAAsH,SAAA,iBAErI,EACAA,EAAAA,IAAC,KAAA,CAAG,UAAU,qBAAqB,SAAA,iBAAc,EACjDA,EAAAA,IAAC,IAAA,CAAE,UAAU,oBAAoB,SAAA,+EAEjC,EAGAD,EAAAA,KAAC,MAAA,CAAI,UAAU,0DACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,UAAU,KAAK,OAAO,OAAO,eAAe,QAAQ,YACjE,SAAA,CAAAC,MAAC,QAAK,EAAE,IAAI,EAAE,KAAK,MAAM,KAAK,OAAO,KAAK,GAAG,IAAI,GAAG,IAAI,YAAY,IAAI,cAAc,QAAQ,eAAe,QAAO,EACpHA,EAAAA,IAAC,QAAK,EAAE,2BAA2B,YAAY,IAAI,cAAc,QAAQ,eAAe,OAAA,CAAO,CAAA,EACjG,EACAA,EAAAA,IAAC,QAAK,SAAA,mDAAA,CAAiD,CAAA,EACzD,EAGAD,EAAAA,KAAC,MAAA,CAAI,UAAU,sDACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,gGAAgG,SAAA,IAE/G,EACAA,EAAAA,IAAC,OAAA,CAAK,UAAU,+BAA+B,SAAA,aAAA,CAAW,CAAA,EAC5D,EACAA,EAAAA,IAAC,MAAA,CAAI,UAAU,yBAAA,CAA0B,EACzCD,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,8FAA8F,SAAA,IAE7G,EACAA,EAAAA,IAAC,OAAA,CAAK,UAAU,+BAA+B,SAAA,QAAA,CAAM,CAAA,EACvD,EACAA,EAAAA,IAAC,MAAA,CAAI,UAAU,uBAAA,CAAwB,EACvCD,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,kGAAkG,SAAA,IAEjH,EACAA,EAAAA,IAAC,OAAA,CAAK,UAAU,iBAAiB,SAAA,YAAA,CAAU,CAAA,CAAA,CAC7C,CAAA,EACF,EAEAD,EAAAA,KAAC,MAAA,CAAI,UAAU,iBAEb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAC,EAAAA,IAAC,QAAA,CAAM,UAAU,gDAAgD,SAAA,sBAEjE,QACC,MAAA,CAAI,UAAU,0BACZ,SAAAJ,EAAeb,CAAO,EACzB,EACAiB,EAAAA,IAACG,EAAA,CACC,MAAOpB,EACP,IAAK,IACL,IAAK,IACL,KAAM,IACN,SAAWqB,GAAMpB,EAAW,OAAOoB,EAAE,OAAO,KAAK,CAAC,EAClD,QAAQ,YACR,MAAM,wBAAA,CAAA,CACR,EACF,QAGC,MAAA,CAAI,UAAU,iCACb,SAAAL,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,qCAAqC,SAAA,gBAAa,QACjE,OAAA,CAAK,UAAU,oCAAqC,SAAAJ,EAAeM,CAAQ,CAAA,CAAE,CAAA,CAAA,CAChF,CAAA,CACF,CAAA,EACF,EAEAF,EAAAA,IAACK,EAAA,CACC,QAASX,EACT,WAAW,0BACX,SAAUT,CAAA,CAAA,CACZ,EACF,CAEJ"}