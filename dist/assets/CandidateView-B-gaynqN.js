import{r as t,P as _,E as k,p as L,L as r,a as v,j as e,g as P,R as E,f as R}from"./index-DncJgOrx.js";import{u as F,s as V,V as X,P as $,S as D,a as W}from"./offers-DJwQVQdK.js";import{P as T,a as Y}from"./client-CZUYQNwL.js";function z({offerId:o}){const[A,x]=t.useState(!0),[h,c]=t.useState(null),[f,p]=t.useState(1e5),[w,g]=t.useState("100,000"),[u,b]=t.useState(!1),[d,C]=t.useState(null),[I,m]=t.useState(!1),[j,l]=t.useState(""),i=t.useRef(null),{enable:N,disable:y}=F(),M=t.useMemo(()=>_.candidateLink.replace("24 hours",`${k.offerHours} hours`),[]);t.useEffect(()=>{async function a(){try{x(!0),i.current&&i.current.abort();const s=new AbortController;i.current=s;const n=await W(o,{signal:s.signal});if(!n){c("Offer not found");return}if(n.status==="invalid"){c("Invalid offer link");return}if(n.status==="expired"){c("Offer has expired");return}}catch(s){if(s?.name==="AbortError")return;c(s.message||"Failed to load offer")}finally{x(!1)}}return a(),()=>{i.current&&i.current.abort()}},[o]);const O=t.useCallback(a=>{const{value:s,display:n}=L(a,r);g(n),p(s),l("")},[]),S=t.useCallback(async()=>{if(!u)try{b(!0),l("");const a=Math.min(Math.max(f,r.TOTAL_MIN),r.TOTAL_MAX);if(a<r.TOTAL_MIN||a>r.TOTAL_MAX){l(`Please keep your minimum between ${v(r.TOTAL_MIN)} and ${v(r.TOTAL_MAX)}.`);return}const s=await V(o,{min:a}),n={status:s.status,finalOffer:s.final,suggested:s.suggested};if(C(n),s?.resultId){setTimeout(()=>{window.location.hash=`#result=${s.resultId}`},100);return}}catch(a){if(a?.name==="AbortError")return;l(a.message||"We could not submit your response. Please retry.")}finally{b(!1)}},[o,u,f]);return A?e.jsx(T,{className:"space-y-6 animate-[cardIn_280ms_ease-out]",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx("div",{className:"h-8 bg-slate-200 rounded w-1/3 mx-auto"}),e.jsx("div",{className:"h-4 bg-slate-100 rounded w-2/3 mx-auto"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-slate-100 rounded w-1/4"}),e.jsx("div",{className:"h-10 bg-slate-200 rounded w-full"}),e.jsx("div",{className:"h-2 bg-slate-200 rounded-full w-full"})]}),e.jsx("div",{className:"h-12 bg-slate-200 rounded-full w-full"})]})}):h?e.jsxs(T,{className:"space-y-6 animate-[cardIn_280ms_ease-out]",children:[e.jsxs("header",{className:"flex flex-col items-center text-center space-y-3",children:[e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-slate-50 ring-4 ring-rose-100 text-4xl text-rose-600 animate-[emojiPop_260ms_ease-out]",children:e.jsx("span",{children:"‚ö†Ô∏è"})}),e.jsx("h1",{className:"text-2xl md:text-3xl font-semibold text-slate-900",children:"We couldn‚Äôt load your offer."}),e.jsx("p",{className:"text-sm md:text-base text-slate-600",children:h})]}),e.jsx("div",{className:"flex flex-col gap-3",children:e.jsx("button",{onClick:P,className:"w-full rounded-full bg-slate-900 text-white py-3 text-sm font-medium hover:bg-slate-800 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-900 focus-visible:ring-offset-2 transition-all active:scale-[0.98]",children:"Request a new link"})})]}):d?e.jsx(E,{status:d.status,finalOffer:d.finalOffer,suggested:d.suggested}):e.jsx("div",{className:"page-grid",children:e.jsx(Y,{className:"animate-[cardIn_280ms_ease-out]",title:"Total compensation","data-focus-mode":I,children:e.jsxs("div",{className:"card-flow",children:[e.jsx(X,{label:"Minimum total compensation you‚Äôd sign for",inputValue:w,onInputChange:O,onFocus:()=>{m(!0),N()},onBlur:()=>{m(!1),y()}}),e.jsx($,{label:"Adjust minimum total compensation",value:f,min:r.TOTAL_MIN,max:r.TOTAL_MAX,step:5e3,onChange:a=>{const s=Number(a.target.value);p(s),g(R(s)),l("")},variant:"candidate",thumbEmoji:"ü™ô",onDragStart:()=>{m(!0),N()},onDragEnd:()=>{m(!1),y()}}),e.jsx("section",{className:"card-block",children:e.jsxs("div",{className:"privacy-note",children:[e.jsx("span",{children:"üîê"}),e.jsx("span",{children:M})]})}),e.jsx("section",{className:"card-block card-block--cta",children:e.jsxs("div",{className:"cta-stack",children:[e.jsx(D,{text:"Slide to Lock Offer",onConfirm:S,loading:u,disabled:u}),j?e.jsxs("p",{className:"cta-error",role:"alert","aria-live":"polite",children:[e.jsx("span",{"aria-hidden":"true",children:"‚ö†Ô∏è"}),e.jsx("span",{children:j})]}):e.jsx("p",{className:"microcopy quiet-text cta-hint",children:"Adjust until it feels right. When you lock it, the company is notified."})]})})]})})})}export{z as CandidateView};
//# sourceMappingURL=CandidateView-B-gaynqN.js.map
