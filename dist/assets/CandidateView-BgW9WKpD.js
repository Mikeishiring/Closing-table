import{r as a,P as S,E as _,p as k,L as r,a as v,j as e,g as L,R as P,f as E}from"./index-BbD2jQxV.js";import{u as R,s as F,V,P as X,S as $,a as W}from"./offers-C4BY2bAa.js";import{a as Y}from"./client-BhLJ3e7R.js";function B({offerId:o}){const[T,x]=a.useState(!0),[h,c]=a.useState(null),[f,p]=a.useState(1e5),[A,g]=a.useState("100,000"),[u,b]=a.useState(!1),[d,C]=a.useState(null),[w,m]=a.useState(!1),[j,n]=a.useState(""),l=a.useRef(null),{enable:N,disable:y}=R(),I=a.useMemo(()=>S.candidateLink.replace("24 hours",`${_.offerHours} hours`),[]);a.useEffect(()=>{async function t(){try{x(!0),l.current&&l.current.abort();const s=new AbortController;l.current=s;const i=await W(o,{signal:s.signal});if(!i){c("Offer not found");return}if(i.status==="invalid"){c("Invalid offer link");return}if(i.status==="expired"){c("Offer has expired");return}}catch(s){if(s?.name==="AbortError")return;c(s.message||"Failed to load offer")}finally{x(!1)}}return t(),()=>{l.current&&l.current.abort()}},[o]);const M=a.useCallback(t=>{const{value:s,display:i}=k(t,r);g(i),p(s),n("")},[]),O=a.useCallback(async()=>{if(!u)try{b(!0),n("");const t=Math.min(Math.max(f,r.TOTAL_MIN),r.TOTAL_MAX);if(t<r.TOTAL_MIN||t>r.TOTAL_MAX){n(`Please keep your minimum between ${v(r.TOTAL_MIN)} and ${v(r.TOTAL_MAX)}.`);return}const s=await F(o,{min:t});if(s?.resultId){window.location.hash=`#result=${s.resultId}`;return}C({status:s.status,finalOffer:s.final,suggested:s.suggested})}catch(t){if(t?.name==="AbortError")return;n(t.message||"We could not submit your response. Please retry.")}finally{b(!1)}},[o,u,f]);return T?e.jsx(PrimaryCard,{className:"space-y-6 animate-[cardIn_280ms_ease-out]",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx("div",{className:"h-8 bg-slate-200 rounded w-1/3 mx-auto"}),e.jsx("div",{className:"h-4 bg-slate-100 rounded w-2/3 mx-auto"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-slate-100 rounded w-1/4"}),e.jsx("div",{className:"h-10 bg-slate-200 rounded w-full"}),e.jsx("div",{className:"h-2 bg-slate-200 rounded-full w-full"})]}),e.jsx("div",{className:"h-12 bg-slate-200 rounded-full w-full"})]})}):h?e.jsxs(PrimaryCard,{className:"space-y-6 animate-[cardIn_280ms_ease-out]",children:[e.jsxs("header",{className:"flex flex-col items-center text-center space-y-3",children:[e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-slate-50 ring-4 ring-rose-100 text-4xl text-rose-600 animate-[emojiPop_260ms_ease-out]",children:e.jsx("span",{children:"‚ö†Ô∏è"})}),e.jsx("h1",{className:"text-2xl md:text-3xl font-semibold text-slate-900",children:"We couldn‚Äôt load your offer."}),e.jsx("p",{className:"text-sm md:text-base text-slate-600",children:h})]}),e.jsx("div",{className:"flex flex-col gap-3",children:e.jsx("button",{onClick:L,className:"w-full rounded-full bg-slate-900 text-white py-3 text-sm font-medium hover:bg-slate-800 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-900 focus-visible:ring-offset-2 transition-all active:scale-[0.98]",children:"Request a new link"})})]}):d?e.jsx(P,{status:d.status,finalOffer:d.finalOffer,suggested:d.suggested}):e.jsx("div",{className:"page-grid",children:e.jsx(Y,{className:"animate-[cardIn_280ms_ease-out]",title:"Total compensation","data-focus-mode":w,children:e.jsxs("div",{className:"card-flow",children:[e.jsx(V,{label:"Minimum total compensation you‚Äôd sign for",inputValue:A,onInputChange:M,onFocus:()=>{m(!0),N()},onBlur:()=>{m(!1),y()}}),e.jsx(X,{label:"Adjust minimum total compensation",value:f,min:r.TOTAL_MIN,max:r.TOTAL_MAX,step:5e3,onChange:t=>{const s=Number(t.target.value);p(s),g(E(s)),n("")},variant:"candidate",thumbEmoji:"ü™ô",onDragStart:()=>{m(!0),N()},onDragEnd:()=>{m(!1),y()}}),e.jsx("section",{className:"card-block",children:e.jsxs("div",{className:"privacy-note",children:[e.jsx("span",{children:"üîê"}),e.jsx("span",{children:I})]})}),e.jsx("section",{className:"card-block card-block--cta",children:e.jsxs("div",{className:"cta-stack",children:[e.jsx($,{text:"Slide to Lock Offer",onConfirm:O,loading:u,disabled:u}),j?e.jsxs("p",{className:"cta-error",role:"alert","aria-live":"polite",children:[e.jsx("span",{"aria-hidden":"true",children:"‚ö†Ô∏è"}),e.jsx("span",{children:j})]}):e.jsx("p",{className:"microcopy quiet-text cta-hint",children:"Adjust until it feels right. When you lock it, the company is notified."})]})})]})})})}export{B as CandidateView};
//# sourceMappingURL=CandidateView-BgW9WKpD.js.map
