{"version":3,"file":"ResultCard-Cc0DAtfA.js","sources":["../../src/components/ResultCard.jsx"],"sourcesContent":["/**\r\n * ResultReveal Component\r\n * Minimalist reveal with big emoji + big headline as visual anchor\r\n */\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { generateResultLink, copyToClipboard } from '../lib/api';\r\n\r\n// Simple status configuration\r\nconst RESULT_CONFIG = {\r\n  success: {\r\n    emoji: \"‚úÖ\",\r\n    color: \"text-emerald-600\",\r\n    bgRing: \"ring-emerald-100\",\r\n    title: \"Deal Closed\",\r\n    line: \"The mechanism found a fair middle ground and split the surplus 50/50.\",\r\n    actionIcon: \"üîÅ\",\r\n  },\r\n  close: {\r\n    emoji: \"ü§è\",\r\n    color: \"text-amber-600\",\r\n    bgRing: \"ring-amber-100\",\r\n    title: \"Close, But Not Quite\",\r\n    line: \"You're within the 10% bridge window. A human conversation could close the gap.\",\r\n    actionIcon: \"üí¨\",\r\n  },\r\n  fail: {\r\n    emoji: \"‚ùå\",\r\n    color: \"text-rose-600\",\r\n    bgRing: \"ring-rose-100\",\r\n    title: \"No Deal Under This Mechanism\",\r\n    line: \"The ranges are too far apart for a fair split under the rules you agreed to.\",\r\n    actionIcon: \"üîç\",\r\n  },\r\n};\r\n\r\n/**\r\n * Format currency for display\r\n */\r\nfunction formatCurrency(value) {\r\n  return new Intl.NumberFormat('en-US', {\r\n    style: 'currency',\r\n    currency: 'USD',\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0,\r\n  }).format(value);\r\n}\r\n\r\n/**\r\n * Animated counter for number reveal\r\n */\r\nfunction useCountUp(target, duration = 350) {\r\n  const [count, setCount] = useState(0);\r\n  const [breathe, setBreathe] = useState(false);\r\n  \r\n  useEffect(() => {\r\n    if (!target || target === 0) return;\r\n    \r\n    const start = performance.now();\r\n    const end = start + duration;\r\n    \r\n    const step = (timestamp) => {\r\n      const progress = Math.min((timestamp - start) / duration, 1);\r\n      const eased = 1 - Math.pow(1 - progress, 3);\r\n      setCount(Math.floor(target * eased));\r\n      \r\n      if (progress < 1) {\r\n        requestAnimationFrame(step);\r\n      } else {\r\n        setCount(target);\r\n        // Trigger breathe animation after count-up\r\n        setTimeout(() => setBreathe(true), 100);\r\n      }\r\n    };\r\n    \r\n    requestAnimationFrame(step);\r\n  }, [target, duration]);\r\n  \r\n  return { count, breathe };\r\n}\r\n\r\n/**\r\n * Main ResultReveal Component\r\n */\r\nexport function ResultCard({ status, finalOffer, suggested, gapPercent, resultId }) {\r\n  const [stage, setStage] = useState('emoji'); // 'emoji' | 'details'\r\n  const [copyLabel, setCopyLabel] = useState('Copy result link');\r\n  const [showHint, setShowHint] = useState(false);\r\n  \r\n  const cfg = RESULT_CONFIG[status];\r\n  const { count: displayFinal, breathe } = useCountUp(status === 'success' ? finalOffer : null, 350);\r\n  \r\n  // Stage timing: emoji first, then details\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => setStage('details'), 120);\r\n    return () => clearTimeout(timer);\r\n  }, []);\r\n  \r\n  // Auto-focus primary button when details appear\r\n  useEffect(() => {\r\n    if (stage === 'details') {\r\n      const btn = document.getElementById('primary-action-btn');\r\n      if (btn) btn.focus();\r\n    }\r\n  }, [stage]);\r\n  \r\n  const handleCopy = async () => {\r\n    const link = generateResultLink(resultId);\r\n    const result = await copyToClipboard(link);\r\n    \r\n    if (result.success) {\r\n      setCopyLabel('Copied ‚úì');\r\n      setTimeout(() => setCopyLabel('Copy result link'), 1500);\r\n    }\r\n  };\r\n  \r\n  const handleNewOffer = () => {\r\n    window.location.hash = '';\r\n    window.location.reload();\r\n  };\r\n  \r\n  // Calculate gap percentage\r\n  const displayGap = gapPercent || (status === 'close' ? 8.0 : null);\r\n  \r\n  return (\r\n    <div className=\"fixed inset-0 flex items-center justify-center bg-slate-900/70 p-4 animate-[fadeIn_280ms_ease-out]\">\r\n      {/* Subtle background shimmer for success only */}\r\n      {status === 'success' && (\r\n        <div className=\"absolute inset-0 bg-gradient-to-br from-emerald-500/5 via-transparent to-transparent animate-pulse\" />\r\n      )}\r\n      \r\n      <div className=\"relative w-full max-w-md\">\r\n        <div className=\"relative bg-white rounded-3xl shadow-xl p-6 md:p-8 animate-[cardIn_280ms_ease-out]\">\r\n          \r\n          {/* Hero band: Big emoji + outcome */}\r\n          <header className=\"flex flex-col items-center text-center\">\r\n            <div\r\n              className={`\r\n                mb-4 flex h-16 w-16 md:h-18 md:w-18 items-center justify-center rounded-full\r\n                bg-slate-50 ring-4 ${cfg.bgRing}\r\n                text-4xl md:text-5xl ${cfg.color}\r\n                animate-[emojiPop_260ms_ease-out]\r\n              `}\r\n            >\r\n              <span>{cfg.emoji}</span>\r\n            </div>\r\n            \r\n            <h1 className={`text-2xl md:text-3xl font-semibold text-slate-900 transition-all duration-300 ${\r\n              stage === 'details' ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-2'\r\n            }`}>\r\n              {cfg.title}\r\n            </h1>\r\n            \r\n            <p className={`mt-2 text-sm md:text-base text-slate-600 max-w-sm transition-all duration-300 delay-75 ${\r\n              stage === 'details' ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-2'\r\n            }`}>\r\n              {cfg.line}\r\n            </p>\r\n          </header>\r\n\r\n          {/* Details band: Content changes by status */}\r\n          <main className={`mt-6 space-y-4 transition-all duration-300 delay-150 ${\r\n            stage === 'details' ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-2'\r\n          }`}>\r\n            \r\n            {/* Success: Big number */}\r\n            {status === 'success' && (\r\n              <section className=\"text-center\">\r\n                <p className=\"text-xs uppercase tracking-[0.18em] text-slate-500\">\r\n                  Final Offer\r\n                </p>\r\n                <p className={`mt-1 text-4xl md:text-5xl font-semibold text-slate-900 ${\r\n                  breathe ? 'animate-[numberBreathe_400ms_ease-in-out]' : ''\r\n                }`}>\r\n                  {formatCurrency(displayFinal)}\r\n                </p>\r\n                <p className=\"mt-2 text-xs text-slate-500\">\r\n                  Exactly between your ranges, without revealing either side's number.\r\n                </p>\r\n              </section>\r\n            )}\r\n            \r\n            {/* Close: Gap percentage */}\r\n            {status === 'close' && (\r\n              <section className=\"text-center space-y-3\">\r\n                <div>\r\n                  <p className=\"text-xs uppercase tracking-[0.18em] text-slate-500\">\r\n                    Gap Size\r\n                  </p>\r\n                  <p className=\"mt-1 text-3xl md:text-4xl font-semibold text-slate-900\">\r\n                    {displayGap.toFixed(1)}%\r\n                  </p>\r\n                </div>\r\n                <p className=\"text-xs text-slate-500 max-w-sm mx-auto\">\r\n                  You're within the 10% bridge window. The mechanism stops here so you can decide together whether to stretch.\r\n                </p>\r\n                {suggested && (\r\n                  <div className=\"rounded-2xl bg-slate-50 px-4 py-3 text-xs text-slate-600\">\r\n                    Non-binding starting point: <span className=\"font-semibold\">{formatCurrency(suggested)}</span>\r\n                  </div>\r\n                )}\r\n              </section>\r\n            )}\r\n            \r\n            {/* Fail: Clear message */}\r\n            {status === 'fail' && (\r\n              <section className=\"text-center space-y-3\">\r\n                <p className=\"text-sm md:text-base text-slate-700 font-medium\">\r\n                  The gap is larger than <span className=\"text-rose-600\">10%</span> of the company's maximum.\r\n                </p>\r\n                <p className=\"text-xs text-slate-500 max-w-sm mx-auto\">\r\n                  The mechanism can't suggest a fair middle without asking one of you to cross your stated limits.\r\n                </p>\r\n              </section>\r\n            )}\r\n            \r\n          </main>\r\n\r\n          {/* Actions band: Buttons */}\r\n          <div className={`mt-6 flex flex-col gap-3 transition-all duration-300 delay-200 ${\r\n            stage === 'details' ? 'opacity-100' : 'opacity-0'\r\n          }`}>\r\n            <button\r\n              id=\"primary-action-btn\"\r\n              onClick={handleCopy}\r\n              className=\"w-full rounded-full bg-slate-900 text-white py-3 text-sm font-medium hover:bg-slate-800 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-900 focus-visible:ring-offset-2 transition-all active:scale-[0.98]\"\r\n            >\r\n              {copyLabel}\r\n            </button>\r\n            \r\n            <button\r\n              onClick={handleNewOffer}\r\n              className=\"w-full rounded-full border border-slate-200 py-3 text-sm text-slate-700 hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2 transition-all active:scale-[0.98]\"\r\n            >\r\n              {status === 'success' ? `Start a new offer ${cfg.actionIcon}` : \r\n               status === 'close' ? `Talk it through ${cfg.actionIcon}` : \r\n               `Back to search ${cfg.actionIcon}`}\r\n            </button>\r\n          </div>\r\n          \r\n          {/* Outcome-only hint */}\r\n          <button\r\n            onClick={() => setShowHint(!showHint)}\r\n            className={`mt-4 w-full flex items-center justify-center gap-2 text-[11px] text-slate-500 hover:text-slate-700 transition-all duration-300 delay-250 ${\r\n              stage === 'details' ? 'opacity-100' : 'opacity-0'\r\n            }`}\r\n          >\r\n            <span>üîê</span>\r\n            <span>Outcome-only: neither side sees the other's number.</span>\r\n          </button>\r\n          \r\n          {showHint && (\r\n            <div className=\"mt-2 px-4 py-3 bg-slate-50 rounded-xl text-xs text-slate-600 animate-[slideDown_200ms_ease-out]\">\r\n              <p>‚Ä¢ Each side's original number stays private</p>\r\n              <p className=\"mt-1\">‚Ä¢ Only this final outcome is shareable</p>\r\n              <p className=\"mt-1\">‚Ä¢ The mechanism is single-use</p>\r\n            </div>\r\n          )}\r\n          \r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Add custom animations to your CSS or Tailwind config\r\nconst styles = `\r\n@keyframes fadeIn {\r\n  0% { opacity: 0; }\r\n  100% { opacity: 1; }\r\n}\r\n\r\n@keyframes cardIn {\r\n  0% { transform: scale(0.96); opacity: 0; }\r\n  100% { transform: scale(1); opacity: 1; }\r\n}\r\n\r\n@keyframes emojiPop {\r\n  0% { transform: scale(0.8); opacity: 0; }\r\n  100% { transform: scale(1); opacity: 1; }\r\n}\r\n\r\n@keyframes numberBreathe {\r\n  0%, 100% { transform: scale(1); }\r\n  50% { transform: scale(1.03); }\r\n}\r\n\r\n@keyframes slideDown {\r\n  0% { transform: translateY(-8px); opacity: 0; }\r\n  100% { transform: translateY(0); opacity: 1; }\r\n}\r\n`;\r\n"],"names":["RESULT_CONFIG","formatCurrency","value","useCountUp","target","duration","count","setCount","useState","breathe","setBreathe","useEffect","start","step","timestamp","progress","eased","ResultCard","status","finalOffer","suggested","gapPercent","resultId","stage","setStage","copyLabel","setCopyLabel","showHint","setShowHint","cfg","displayFinal","timer","btn","handleCopy","link","generateResultLink","copyToClipboard","handleNewOffer","displayGap","jsxs","jsx"],"mappings":"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"}