{"version":3,"file":"api-PqKgA-tP.js","sources":["../../src/lib/api.js"],"sourcesContent":["/**\n * API Client Module\n * Centralized API calls with consistent error handling\n */\n\nconst API_BASE =\n  import.meta.env.VITE_API_BASE ||\n  (typeof window !== 'undefined' && window.location.hostname === 'localhost'\n    ? 'http://localhost:3000'\n    : 'https://closing-table-backend.onrender.com');\n\n// Optional frontend base for shareable links\nconst FRONTEND_BASE =\n  import.meta.env.VITE_APP_BASE_URL ||\n  (typeof window !== 'undefined'\n    ? `${window.location.origin}${window.location.pathname}`\n    : '');\n\n// Add timeout support\nconst DEFAULT_TIMEOUT = 10000; // 10 seconds\n\n/**\n * Generic API call wrapper with error handling and timeout\n */\nasync function api(path, options = {}) {\n  const url = `${API_BASE}${path}`;\n  \n  const config = {\n    headers: {\n      'Content-Type': 'application/json',\n      ...(options.headers || {}),\n    },\n    ...options,\n  };\n\n  // Create timeout promise\n  const timeoutPromise = new Promise((_, reject) => {\n    setTimeout(() => reject(new Error('Request timeout')), DEFAULT_TIMEOUT);\n  });\n\n  try {\n    const fetchPromise = fetch(url, config);\n    const res = await Promise.race([fetchPromise, timeoutPromise]);\n    let data;\n\n    // Try to parse JSON response\n    try {\n      data = await res.json();\n    } catch {\n      // If JSON parse fails and response is not OK, throw generic error\n      if (!res.ok) {\n        throw new Error(`HTTP ${res.status}: ${res.statusText}`);\n      }\n      return null;\n    }\n\n    // If response is not OK, throw with error message from server or generic\n    if (!res.ok) {\n      throw new Error(data.error || `HTTP ${res.status}: ${res.statusText}`);\n    }\n\n    return data;\n  } catch (error) {\n    // Network errors or fetch failures\n    if (error instanceof TypeError) {\n      throw new Error('Network error. Please check your connection.');\n    }\n    throw error;\n  }\n}\n\n/**\n * Create a new offer (Company side)\n */\nexport async function createOffer(offerData) {\n  return api('/api/offers', {\n    method: 'POST',\n    body: JSON.stringify(offerData),\n  });\n}\n\n/**\n * Get offer details (Candidate side)\n */\nexport async function getOffer(offerId) {\n  return api(`/api/offers/${offerId}`);\n}\n\n/**\n * Submit candidate response\n */\nexport async function submitResponse(offerId, responseData) {\n  return api(`/api/offers/${offerId}/response`, {\n    method: 'POST',\n    body: JSON.stringify(responseData),\n  });\n}\n\n/**\n * Get result by ID\n */\nexport async function getResult(resultId) {\n  return api(`/api/results/${resultId}`);\n}\n\n/**\n * Validate email format\n */\nexport function isValidEmail(email) {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(email);\n}\n\n/**\n * Generate shareable link for offer\n */\nexport function generateOfferLink(offerId) {\n  const base = FRONTEND_BASE || (typeof window !== 'undefined'\n    ? `${window.location.origin}${window.location.pathname}`\n    : '');\n  return `${base}#offer=${offerId}`;\n}\n\n/**\n * Generate shareable link for result\n */\nexport function generateResultLink(resultId) {\n  const base = FRONTEND_BASE || (typeof window !== 'undefined'\n    ? `${window.location.origin}${window.location.pathname}`\n    : '');\n  return `${base}#result=${resultId}`;\n}\n\n/**\n * Copy text to clipboard (with fallback)\n */\nexport async function copyToClipboard(text) {\n  // Try modern clipboard API first\n  if (navigator.clipboard && navigator.clipboard.writeText) {\n    try {\n      await navigator.clipboard.writeText(text);\n      return { success: true };\n    } catch (error) {\n      // Fall through to legacy method\n    }\n  }\n\n  // Fallback: hidden textarea method\n  try {\n    const textarea = document.createElement('textarea');\n    textarea.value = text;\n    textarea.style.position = 'fixed';\n    textarea.style.opacity = '0';\n    document.body.appendChild(textarea);\n    textarea.select();\n    const success = document.execCommand('copy');\n    document.body.removeChild(textarea);\n    return { success };\n  } catch (error) {\n    return { success: false, error: error.message };\n  }\n}\n\n"],"names":["API_BASE","FRONTEND_BASE","DEFAULT_TIMEOUT","api","path","options","url","config","timeoutPromise","_","reject","fetchPromise","res","data","error","createOffer","offerData","getOffer","offerId","submitResponse","responseData","getResult","resultId","generateOfferLink","generateResultLink","copyToClipboard","text","textarea","success"],"mappings":"AAKA,MAAMA,EAEH,OAAO,OAAW,KAAe,OAAO,SAAS,WAAa,YAC3D,wBACA,6CAGAC,EAEH,OAAO,OAAW,IACf,GAAG,OAAO,SAAS,MAAM,GAAG,OAAO,SAAS,QAAQ,GACpD,GAGAC,EAAkB,IAKxB,eAAeC,EAAIC,EAAMC,EAAU,GAAI,CACrC,MAAMC,EAAM,GAAGN,CAAQ,GAAGI,CAAI,GAExBG,EAAS,CACb,QAAS,CACP,eAAgB,mBAChB,GAAIF,EAAQ,SAAW,CAAA,CAAC,EAE1B,GAAGA,CAAA,EAICG,EAAiB,IAAI,QAAQ,CAACC,EAAGC,IAAW,CAChD,WAAW,IAAMA,EAAO,IAAI,MAAM,iBAAiB,CAAC,EAAGR,CAAe,CACxE,CAAC,EAED,GAAI,CACF,MAAMS,EAAe,MAAML,EAAKC,CAAM,EAChCK,EAAM,MAAM,QAAQ,KAAK,CAACD,EAAcH,CAAc,CAAC,EAC7D,IAAIK,EAGJ,GAAI,CACFA,EAAO,MAAMD,EAAI,KAAA,CACnB,MAAQ,CAEN,GAAI,CAACA,EAAI,GACP,MAAM,IAAI,MAAM,QAAQA,EAAI,MAAM,KAAKA,EAAI,UAAU,EAAE,EAEzD,OAAO,IACT,CAGA,GAAI,CAACA,EAAI,GACP,MAAM,IAAI,MAAMC,EAAK,OAAS,QAAQD,EAAI,MAAM,KAAKA,EAAI,UAAU,EAAE,EAGvE,OAAOC,CACT,OAASC,EAAO,CAEd,MAAIA,aAAiB,UACb,IAAI,MAAM,8CAA8C,EAE1DA,CACR,CACF,CAKA,eAAsBC,EAAYC,EAAW,CAC3C,OAAOb,EAAI,cAAe,CACxB,OAAQ,OACR,KAAM,KAAK,UAAUa,CAAS,CAAA,CAC/B,CACH,CAKA,eAAsBC,EAASC,EAAS,CACtC,OAAOf,EAAI,eAAee,CAAO,EAAE,CACrC,CAKA,eAAsBC,EAAeD,EAASE,EAAc,CAC1D,OAAOjB,EAAI,eAAee,CAAO,YAAa,CAC5C,OAAQ,OACR,KAAM,KAAK,UAAUE,CAAY,CAAA,CAClC,CACH,CAKA,eAAsBC,EAAUC,EAAU,CACxC,OAAOnB,EAAI,gBAAgBmB,CAAQ,EAAE,CACvC,CAaO,SAASC,EAAkBL,EAAS,CAIzC,MAAO,GAHMjB,IAAkB,OAAO,OAAW,IAC7C,GAAG,OAAO,SAAS,MAAM,GAAG,OAAO,SAAS,QAAQ,GACpD,GACU,UAAUiB,CAAO,EACjC,CAKO,SAASM,EAAmBF,EAAU,CAI3C,MAAO,GAHMrB,IAAkB,OAAO,OAAW,IAC7C,GAAG,OAAO,SAAS,MAAM,GAAG,OAAO,SAAS,QAAQ,GACpD,GACU,WAAWqB,CAAQ,EACnC,CAKA,eAAsBG,EAAgBC,EAAM,CAE1C,GAAI,UAAU,WAAa,UAAU,UAAU,UAC7C,GAAI,CACF,aAAM,UAAU,UAAU,UAAUA,CAAI,EACjC,CAAE,QAAS,EAAA,CACpB,MAAgB,CAEhB,CAIF,GAAI,CACF,MAAMC,EAAW,SAAS,cAAc,UAAU,EAClDA,EAAS,MAAQD,EACjBC,EAAS,MAAM,SAAW,QAC1BA,EAAS,MAAM,QAAU,IACzB,SAAS,KAAK,YAAYA,CAAQ,EAClCA,EAAS,OAAA,EACT,MAAMC,EAAU,SAAS,YAAY,MAAM,EAC3C,gBAAS,KAAK,YAAYD,CAAQ,EAC3B,CAAE,QAAAC,CAAA,CACX,OAASd,EAAO,CACd,MAAO,CAAE,QAAS,GAAO,MAAOA,EAAM,OAAA,CACxC,CACF"}